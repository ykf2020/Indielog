{"ast":null,"code":"var _jsxFileName = \"/Users/fanyukun/Documents/react/indielog/src/pages/BlogPost/index.js\",\n    _s = $RefreshSig$();\n\nimport { useState, useEffect } from 'react';\nimport { getPostWithAuthorInfo } from '../../utils/firebase';\nimport \"firebase/compat/firestore\";\nimport { useSelector } from \"react-redux\";\nimport { useParams } from 'react-router-dom';\nimport CommentArea from '../../components/CommentArea';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faHeart } from '@fortawesome/free-solid-svg-icons';\nimport { BlogPostPageContainer, PostContainer, PostPic, PostDesc, PostTitle, PostContentWrapper, AuthorContainer, AuthorContainerTitle, AuthorImg, AuthorInfo, AuthorName, AuthorDesc, LikeButtonDiv, LikePush, LikeNumber } from './BlogPostElements.js';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nconst BlogPost = () => {\n  _s();\n\n  var _post$likedBy, _post$createdAt, _post$likedBy2;\n\n  const user = useSelector(store => store.user.currentUser);\n  const {\n    postId\n  } = useParams();\n  const [post, setPost] = useState({});\n  const [authorInfo, setAuthorInfo] = useState({});\n  const isLiked = (_post$likedBy = post.likedBy) === null || _post$likedBy === void 0 ? void 0 : _post$likedBy.includes(user === null || user === void 0 ? void 0 : user.uid);\n  useEffect(() => {\n    getPostWithAuthorInfo(postId, setPost, setAuthorInfo);\n  }, []);\n\n  function toggleLiked() {\n    if (!user) {\n      alert('請先登入會員才能按讚～');\n      return;\n    }\n\n    if (isLiked) {\n      firebase.firestore().collection('posts').doc(postId).update({\n        likedBy: firebase.firestore.FieldValue.arrayRemove(user.uid)\n      });\n    } else {\n      firebase.firestore().collection('posts').doc(postId).update({\n        likedBy: firebase.firestore.FieldValue.arrayUnion(user.uid)\n      });\n    }\n  }\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: /*#__PURE__*/_jsxDEV(BlogPostPageContainer, {\n      children: [/*#__PURE__*/_jsxDEV(PostContainer, {\n        children: [/*#__PURE__*/_jsxDEV(PostTitle, {\n          children: post.title\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 59,\n          columnNumber: 7\n        }, this), /*#__PURE__*/_jsxDEV(PostPic, {\n          src: post.imageUrl\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 60,\n          columnNumber: 7\n        }, this), /*#__PURE__*/_jsxDEV(PostDesc, {\n          children: [(_post$createdAt = post.createdAt) === null || _post$createdAt === void 0 ? void 0 : _post$createdAt.toDate().toLocaleString([], {\n            year: 'numeric',\n            month: 'numeric',\n            day: 'numeric'\n          }), \" | \", post.topic]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 61,\n          columnNumber: 7\n        }, this), /*#__PURE__*/_jsxDEV(PostContentWrapper, {\n          dangerouslySetInnerHTML: {\n            __html: post.content\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 62,\n          columnNumber: 7\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 58,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(LikePush, {\n        children: \"\\u89BA\\u5F97\\u6587\\u7AE0\\u4E0D\\u932F\\u55CE\\uFF1F\\u6309\\u500B\\u8B9A\\u5427\\uFF01\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 64,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(LikeButtonDiv, {\n        isLiked: isLiked,\n        onClick: toggleLiked,\n        children: [/*#__PURE__*/_jsxDEV(FontAwesomeIcon, {\n          icon: faHeart\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 66,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(LikeNumber, {\n          children: (_post$likedBy2 = post.likedBy) === null || _post$likedBy2 === void 0 ? void 0 : _post$likedBy2.length\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 67,\n          columnNumber: 9\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 65,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(AuthorContainer, {\n        children: [/*#__PURE__*/_jsxDEV(AuthorContainerTitle, {\n          children: \"\\u95DC\\u65BC\\u4F5C\\u8005\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 70,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(AuthorImg, {\n          children: /*#__PURE__*/_jsxDEV(\"img\", {\n            src: (authorInfo === null || authorInfo === void 0 ? void 0 : authorInfo.photoURL) ? authorInfo === null || authorInfo === void 0 ? void 0 : authorInfo.photoURL : '/default-user-image.png'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 71,\n            columnNumber: 20\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 71,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(AuthorInfo, {\n          children: [/*#__PURE__*/_jsxDEV(AuthorName, {\n            children: authorInfo === null || authorInfo === void 0 ? void 0 : authorInfo.displayName\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 73,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(AuthorDesc, {\n            children: authorInfo === null || authorInfo === void 0 ? void 0 : authorInfo.introduction\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 74,\n            columnNumber: 11\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 72,\n          columnNumber: 9\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 69,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(CommentArea, {\n        area: 'posts',\n        id: postId\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 77,\n        columnNumber: 7\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 57,\n      columnNumber: 5\n    }, this)\n  }, void 0, false);\n};\n\n_s(BlogPost, \"oI75tjt4WrJS45jBwu4JmdHXzng=\", false, function () {\n  return [useSelector, useParams];\n});\n\n_c = BlogPost;\nexport default BlogPost;\n\nvar _c;\n\n$RefreshReg$(_c, \"BlogPost\");","map":{"version":3,"sources":["/Users/fanyukun/Documents/react/indielog/src/pages/BlogPost/index.js"],"names":["useState","useEffect","getPostWithAuthorInfo","useSelector","useParams","CommentArea","FontAwesomeIcon","faHeart","BlogPostPageContainer","PostContainer","PostPic","PostDesc","PostTitle","PostContentWrapper","AuthorContainer","AuthorContainerTitle","AuthorImg","AuthorInfo","AuthorName","AuthorDesc","LikeButtonDiv","LikePush","LikeNumber","BlogPost","user","store","currentUser","postId","post","setPost","authorInfo","setAuthorInfo","isLiked","likedBy","includes","uid","toggleLiked","alert","firebase","firestore","collection","doc","update","FieldValue","arrayRemove","arrayUnion","title","imageUrl","createdAt","toDate","toLocaleString","year","month","day","topic","__html","content","length","photoURL","displayName","introduction"],"mappings":"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","sourcesContent":["import { useState, useEffect } from 'react'\nimport { getPostWithAuthorInfo } from '../../utils/firebase'\nimport \"firebase/compat/firestore\"\nimport { useSelector } from \"react-redux\";\nimport { useParams } from 'react-router-dom'\nimport CommentArea from '../../components/CommentArea'\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\nimport { faHeart } from '@fortawesome/free-solid-svg-icons'\nimport {\n  BlogPostPageContainer,\n  PostContainer,\n  PostPic,\n  PostDesc,\n  PostTitle,\n  PostContentWrapper,\n  AuthorContainer,\n  AuthorContainerTitle,\n  AuthorImg,\n  AuthorInfo,\n  AuthorName,\n  AuthorDesc,\n  LikeButtonDiv,\n  LikePush,\n  LikeNumber\n} from './BlogPostElements.js'\n\n\nconst BlogPost = () => {\n  const user = useSelector((store) => store.user.currentUser)\n  const { postId } = useParams()\n  const [post, setPost] = useState({})\n  const [authorInfo, setAuthorInfo] = useState({})\n  const isLiked = post.likedBy?.includes(user?.uid)\n\n  useEffect(() => {\n    getPostWithAuthorInfo(postId, setPost, setAuthorInfo)\n  },[])\n\n  function toggleLiked() {\n    if(!user) {\n      alert('請先登入會員才能按讚～')\n      return\n    }\n    if(isLiked) {\n      firebase.firestore().collection('posts').doc(postId).update({\n        likedBy: firebase.firestore.FieldValue.arrayRemove(user.uid)\n      })\n    } else {\n      firebase.firestore().collection('posts').doc(postId).update({\n        likedBy: firebase.firestore.FieldValue.arrayUnion(user.uid)\n      })\n    }\n  }\n\n  return (\n    <>\n    <BlogPostPageContainer>\n      <PostContainer>\n      <PostTitle>{post.title}</PostTitle>\n      <PostPic src={post.imageUrl}></PostPic>\n      <PostDesc>{post.createdAt?.toDate().toLocaleString([],{year: 'numeric', month: 'numeric', day: 'numeric'})} | {post.topic}</PostDesc>\n      <PostContentWrapper dangerouslySetInnerHTML={{__html: post.content}}/>\n      </PostContainer>\n      <LikePush>覺得文章不錯嗎？按個讚吧！</LikePush>\n      <LikeButtonDiv isLiked={isLiked} onClick={toggleLiked}>\n        <FontAwesomeIcon icon={faHeart} />\n        <LikeNumber>{post.likedBy?.length}</LikeNumber>\n      </LikeButtonDiv>\n      <AuthorContainer>\n        <AuthorContainerTitle>關於作者</AuthorContainerTitle>\n        <AuthorImg><img src={authorInfo?.photoURL ? authorInfo?.photoURL : '/default-user-image.png'}/></AuthorImg>\n        <AuthorInfo>\n          <AuthorName>{authorInfo?.displayName}</AuthorName>\n          <AuthorDesc>{authorInfo?.introduction}</AuthorDesc>\n        </AuthorInfo>\n      </AuthorContainer>\n      <CommentArea area={'posts'} id={postId} />\n    </BlogPostPageContainer>\n    </>\n  )\n}\n\nexport default BlogPost\n"]},"metadata":{},"sourceType":"module"}
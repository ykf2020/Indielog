{"ast":null,"code":"var _jsxFileName = \"/Users/fanyukun/Documents/react/indielog/src/components/CommentArea/index.js\",\n    _s = $RefreshSig$();\n\nimport { useState, useEffect } from 'react';\nimport { CommentsContainer, CommentAddSection, Notice, CommentAddArea, CommentInfo, CommentorImgDiv, CommentorName, CommentorDate, CommentTextArea, CommentButtons, Comment, CommentContent } from './CommentAreaElements.js';\nimport firebase from '../../utils/firebase.js';\nimport 'firebase/compat/auth';\nimport \"firebase/compat/firestore\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst CommentArea = ({\n  postId\n}) => {\n  _s();\n\n  const user = firebase.auth().currentUser;\n  const [commentInput, setCommentInput] = useState('');\n  const [comments, setComments] = useState([]);\n\n  const handleCommentInputSubmit = () => {\n    firebase.firestore().collection('posts').doc(postId).collection('comments').doc().set({\n      content: commentInput,\n      createdAt: firebase.firestore.Timestamp.now(),\n      authorUid: user.uid\n    }).then(() => {\n      setCommentInput('');\n    });\n  };\n\n  useEffect(() => {\n    firebase.firestore().collection('posts').doc(postId).collection('comments').onSnapshot(collectionSnapShot => {\n      const data = collectionSnapShot.docs.map(doc => {\n        const getAuthor = firebase.firestore().collection('users').doc(doc.data().authorUid).get().then(authorSnapShot => {\n          return authorSnapShot.data();\n        });\n\n        const printAuthor = async () => {\n          const a = await getAuthor;\n        };\n\n        printAuthor();\n        return {\n          authorUid: doc.data().authorUid,\n          content: doc.data().content,\n          createdAt: doc.data().createdAt\n        };\n      });\n      setComments(data);\n    });\n  }, []);\n  useEffect(() => {\n    console.log(comments);\n  }, [comments]);\n  return /*#__PURE__*/_jsxDEV(CommentsContainer, {\n    children: [/*#__PURE__*/_jsxDEV(CommentAddSection, {\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        children: \"\\u7559\\u8A00\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 74,\n        columnNumber: 9\n      }, this), user ? /*#__PURE__*/_jsxDEV(CommentAddArea, {\n        children: [/*#__PURE__*/_jsxDEV(CommentInfo, {\n          children: [/*#__PURE__*/_jsxDEV(CommentorImgDiv, {\n            children: /*#__PURE__*/_jsxDEV(\"img\", {\n              src: user.photoURL ? user.photoURL : 'https://assets.juksy.com/files/articles/108444/800x_100_w-60934d08db2e1.jpg'\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 78,\n              columnNumber: 32\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 78,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(CommentorName, {\n            children: user.displayName\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 79,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 77,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(CommentTextArea, {\n          placeholder: \"\\u9EDE\\u6B64\\u8F38\\u5165\\u7559\\u8A00...\",\n          value: commentInput,\n          onChange: e => setCommentInput(e.target.value)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 81,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(CommentButtons, {\n          children: /*#__PURE__*/_jsxDEV(\"p\", {\n            onClick: handleCommentInputSubmit,\n            children: \"\\u9001\\u51FA\\u7559\\u8A00\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 84,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 83,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 76,\n        columnNumber: 11\n      }, this) : /*#__PURE__*/_jsxDEV(Notice, {\n        children: [\"\\u8ACB\\u5148\", /*#__PURE__*/_jsxDEV(\"span\", {\n          children: \"\\u767B\\u5165\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 88,\n          columnNumber: 21\n        }, this), \"\\u4EE5\\u7559\\u8A00\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 88,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 73,\n      columnNumber: 7\n    }, this), comments.map(comment => {\n      var _comment$author, _comment$author2, _comment$createdAt;\n\n      return /*#__PURE__*/_jsxDEV(Comment, {\n        children: [/*#__PURE__*/_jsxDEV(CommentInfo, {\n          children: [/*#__PURE__*/_jsxDEV(CommentorImgDiv, {\n            children: /*#__PURE__*/_jsxDEV(\"img\", {\n              src: ((_comment$author = comment.author) === null || _comment$author === void 0 ? void 0 : _comment$author.photoURL) ? comment.author.photoURL : 'https://assets.juksy.com/files/articles/108444/800x_100_w-60934d08db2e1.jpg'\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 95,\n              columnNumber: 32\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 95,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(CommentorName, {\n            children: (_comment$author2 = comment.author) === null || _comment$author2 === void 0 ? void 0 : _comment$author2.displayName\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 96,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(CommentorDate, {\n            children: (_comment$createdAt = comment.createdAt) === null || _comment$createdAt === void 0 ? void 0 : _comment$createdAt.toDate().toLocaleString()\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 97,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 94,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(CommentContent, {\n          children: comment.content\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 99,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(CommentButtons, {\n          children: [/*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"\\uFF081\\uFF09\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 103,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"\\uFF082\\uFF09\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 104,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"\\uFF083\\uFF09\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 105,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 102,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 93,\n        columnNumber: 11\n      }, this);\n    })]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 72,\n    columnNumber: 5\n  }, this);\n};\n\n_s(CommentArea, \"/YBK2SExvWoiKPBPTmVNuPpLcCA=\");\n\n_c = CommentArea;\nexport default CommentArea;\n\nvar _c;\n\n$RefreshReg$(_c, \"CommentArea\");","map":{"version":3,"sources":["/Users/fanyukun/Documents/react/indielog/src/components/CommentArea/index.js"],"names":["useState","useEffect","CommentsContainer","CommentAddSection","Notice","CommentAddArea","CommentInfo","CommentorImgDiv","CommentorName","CommentorDate","CommentTextArea","CommentButtons","Comment","CommentContent","firebase","CommentArea","postId","user","auth","currentUser","commentInput","setCommentInput","comments","setComments","handleCommentInputSubmit","firestore","collection","doc","set","content","createdAt","Timestamp","now","authorUid","uid","then","onSnapshot","collectionSnapShot","data","docs","map","getAuthor","get","authorSnapShot","printAuthor","a","console","log","photoURL","displayName","e","target","value","comment","author","toDate","toLocaleString"],"mappings":"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","sourcesContent":["import { useState, useEffect } from 'react'\nimport {\n  CommentsContainer,\n  CommentAddSection,\n  Notice,\n  CommentAddArea,\n  CommentInfo,\n  CommentorImgDiv,\n  CommentorName,\n  CommentorDate,\n  CommentTextArea,\n  CommentButtons,\n  Comment,\n  CommentContent,\n} from './CommentAreaElements.js'\nimport firebase from '../../utils/firebase.js'\nimport 'firebase/compat/auth';\nimport \"firebase/compat/firestore\"\n\nconst CommentArea = ({ postId }) => {\n  const user = firebase.auth().currentUser\n  const [commentInput, setCommentInput] = useState('')\n  const [comments, setComments] = useState([])\n  const handleCommentInputSubmit = () => {\n    firebase\n      .firestore()\n      .collection('posts')\n      .doc(postId)\n      .collection('comments')\n      .doc()\n      .set({\n        content: commentInput,\n        createdAt: firebase.firestore.Timestamp.now(),\n        authorUid: user.uid,\n      }).then(() => {\n        setCommentInput('')\n      })\n  }\n  useEffect(() => {\n    firebase\n      .firestore()\n      .collection('posts')\n      .doc(postId)\n      .collection('comments')\n      .onSnapshot((collectionSnapShot) => {\n         const data = collectionSnapShot.docs.map((doc) => {\n           const getAuthor = firebase\n               .firestore()\n               .collection('users')\n               .doc(doc.data().authorUid)\n               .get()\n               .then((authorSnapShot) => {\n                 return authorSnapShot.data()\n               })\n          const printAuthor = async () => {\n            const a = await getAuthor\n          }\n          printAuthor()\n           return {\n             authorUid: doc.data().authorUid,\n             content: doc.data().content,\n             createdAt: doc.data().createdAt\n           }\n         })\n         setComments(data)\n      })\n  },[])\n  useEffect(() => {\n    console.log(comments)\n  },[comments])\n  return (\n    <CommentsContainer>\n      <CommentAddSection>\n        <h3>留言</h3>\n        {user ?\n          <CommentAddArea>\n            <CommentInfo>\n              <CommentorImgDiv><img src={user.photoURL ? user.photoURL : 'https://assets.juksy.com/files/articles/108444/800x_100_w-60934d08db2e1.jpg'}/></CommentorImgDiv>\n              <CommentorName>{user.displayName}</CommentorName>\n            </CommentInfo>\n            <CommentTextArea placeholder='點此輸入留言...' value={commentInput} onChange={(e)=> setCommentInput(e.target.value)}>\n            </CommentTextArea>\n            <CommentButtons>\n              <p onClick={handleCommentInputSubmit}>送出留言</p>\n            </CommentButtons>\n          </CommentAddArea>\n          :\n          <Notice>請先<span>登入</span>以留言</Notice>\n        }\n      </CommentAddSection>\n      {comments.map(comment => {\n        return (\n          <Comment>\n            <CommentInfo>\n              <CommentorImgDiv><img src={comment.author?.photoURL ? comment.author.photoURL : 'https://assets.juksy.com/files/articles/108444/800x_100_w-60934d08db2e1.jpg'}/></CommentorImgDiv>\n              <CommentorName>{comment.author?.displayName}</CommentorName>\n              <CommentorDate>{comment.createdAt?.toDate().toLocaleString()}</CommentorDate>\n            </CommentInfo>\n            <CommentContent>\n              {comment.content}\n            </CommentContent>\n            <CommentButtons>\n              <p>（1）</p>\n              <p>（2）</p>\n              <p>（3）</p>\n            </CommentButtons>\n          </Comment>\n        )\n      })}\n\n    </CommentsContainer>\n  )\n}\n\nexport default CommentArea\n"]},"metadata":{},"sourceType":"module"}
{"ast":null,"code":"import _slicedToArray from\"/Users/fanyukun/Documents/react/Indielog/Indielog/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{useState,useEffect}from'react';import{getPostWithAuthorInfo,togglePostLiked}from'../../utils/firebase';import{useSelector,useDispatch}from\"react-redux\";import{useParams}from'react-router-dom';import CommentArea from'../../components/CommentArea';import{FontAwesomeIcon}from'@fortawesome/react-fontawesome';import{faHeart}from'@fortawesome/free-solid-svg-icons';import{BlogPostPageContainer,PostContainer,PostPic,PostDesc,PostTitle,PostContentWrapper,AuthorContainer,AuthorContainerTitle,AuthorImg,AuthorInfo,AuthorName,AuthorDesc,LikeButtonDiv,LikePush,LikeNumber}from'./BlogPostElements.js';import{setCurrentTitle}from\"../../redux/reducers/pageTitleReducer\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var BlogPost=function BlogPost(){var _post$likedBy,_post$createdAt,_post$likedBy2;var dispatch=useDispatch();var user=useSelector(function(store){return store.user.currentUser;});var _useParams=useParams(),postId=_useParams.postId;var _useState=useState({}),_useState2=_slicedToArray(_useState,2),post=_useState2[0],setPost=_useState2[1];var _useState3=useState({}),_useState4=_slicedToArray(_useState3,2),authorInfo=_useState4[0],setAuthorInfo=_useState4[1];var isLiked=(_post$likedBy=post.likedBy)===null||_post$likedBy===void 0?void 0:_post$likedBy.includes(user===null||user===void 0?void 0:user.uid);useEffect(function(){getPostWithAuthorInfo(postId,setPost,setAuthorInfo);},[]);useEffect(function(){if(!post)return;dispatch(setCurrentTitle(post.title));return function(){dispatch(setCurrentTitle('Indielog'));};},[post]);function toggleLiked(){if(!user){alert('請先登入會員才能按讚～');return;}togglePostLiked(isLiked,postId,user.uid);}return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(BlogPostPageContainer,{children:[/*#__PURE__*/_jsxs(PostContainer,{children:[/*#__PURE__*/_jsx(PostTitle,{children:post.title}),/*#__PURE__*/_jsx(PostPic,{src:post.imageUrl}),/*#__PURE__*/_jsxs(PostDesc,{children:[(_post$createdAt=post.createdAt)===null||_post$createdAt===void 0?void 0:_post$createdAt.toDate().toLocaleString([],{year:'numeric',month:'numeric',day:'numeric'}),\" | \",post.topic]}),/*#__PURE__*/_jsx(PostContentWrapper,{dangerouslySetInnerHTML:{__html:post.content}})]}),/*#__PURE__*/_jsx(LikePush,{children:\"\\u89BA\\u5F97\\u6587\\u7AE0\\u4E0D\\u932F\\u55CE\\uFF1F\\u6309\\u500B\\u8B9A\\u5427\\uFF01\"}),/*#__PURE__*/_jsxs(LikeButtonDiv,{isLiked:isLiked,onClick:toggleLiked,children:[/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:faHeart}),/*#__PURE__*/_jsx(LikeNumber,{children:(_post$likedBy2=post.likedBy)===null||_post$likedBy2===void 0?void 0:_post$likedBy2.length})]}),/*#__PURE__*/_jsxs(AuthorContainer,{children:[/*#__PURE__*/_jsx(AuthorContainerTitle,{children:\"\\u95DC\\u65BC\\u4F5C\\u8005\"}),/*#__PURE__*/_jsx(AuthorImg,{children:/*#__PURE__*/_jsx(\"img\",{alt:\"\",src:(authorInfo===null||authorInfo===void 0?void 0:authorInfo.photoURL)?authorInfo===null||authorInfo===void 0?void 0:authorInfo.photoURL:'/default-user-image.png'})}),/*#__PURE__*/_jsxs(AuthorInfo,{children:[/*#__PURE__*/_jsx(AuthorName,{children:authorInfo===null||authorInfo===void 0?void 0:authorInfo.displayName}),/*#__PURE__*/_jsx(AuthorDesc,{children:authorInfo===null||authorInfo===void 0?void 0:authorInfo.introduction})]})]}),/*#__PURE__*/_jsx(CommentArea,{area:'posts',id:postId})]})});};export default BlogPost;","map":{"version":3,"sources":["/Users/fanyukun/Documents/react/Indielog/Indielog/src/pages/BlogPost/index.js"],"names":["useState","useEffect","getPostWithAuthorInfo","togglePostLiked","useSelector","useDispatch","useParams","CommentArea","FontAwesomeIcon","faHeart","BlogPostPageContainer","PostContainer","PostPic","PostDesc","PostTitle","PostContentWrapper","AuthorContainer","AuthorContainerTitle","AuthorImg","AuthorInfo","AuthorName","AuthorDesc","LikeButtonDiv","LikePush","LikeNumber","setCurrentTitle","BlogPost","dispatch","user","store","currentUser","postId","post","setPost","authorInfo","setAuthorInfo","isLiked","likedBy","includes","uid","title","toggleLiked","alert","imageUrl","createdAt","toDate","toLocaleString","year","month","day","topic","__html","content","length","photoURL","displayName","introduction"],"mappings":"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","sourcesContent":["import { useState, useEffect } from 'react'\nimport { getPostWithAuthorInfo, togglePostLiked } from '../../utils/firebase'\nimport { useSelector, useDispatch } from \"react-redux\";\nimport { useParams } from 'react-router-dom'\nimport CommentArea from '../../components/CommentArea'\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\nimport { faHeart } from '@fortawesome/free-solid-svg-icons'\nimport {\n  BlogPostPageContainer,\n  PostContainer,\n  PostPic,\n  PostDesc,\n  PostTitle,\n  PostContentWrapper,\n  AuthorContainer,\n  AuthorContainerTitle,\n  AuthorImg,\n  AuthorInfo,\n  AuthorName,\n  AuthorDesc,\n  LikeButtonDiv,\n  LikePush,\n  LikeNumber\n} from './BlogPostElements.js'\nimport { setCurrentTitle } from \"../../redux/reducers/pageTitleReducer\"\n\n\nconst BlogPost = () => {\n  const dispatch = useDispatch()\n  const user = useSelector((store) => store.user.currentUser)\n  const { postId } = useParams()\n  const [post, setPost] = useState({})\n  const [authorInfo, setAuthorInfo] = useState({})\n  const isLiked = post.likedBy?.includes(user?.uid)\n\n  useEffect(() => {\n    getPostWithAuthorInfo(postId, setPost, setAuthorInfo)\n  },[])\n\n  useEffect(() => {\n    if(!post) return\n    dispatch(setCurrentTitle(post.title))\n\n    return () => {\n      dispatch(setCurrentTitle('Indielog'))\n    }\n  },[post])\n\n  function toggleLiked() {\n    if(!user) {\n      alert('請先登入會員才能按讚～')\n      return\n    }\n    togglePostLiked(isLiked, postId, user.uid)\n  }\n\n  return (\n    <>\n    <BlogPostPageContainer>\n      <PostContainer>\n      <PostTitle>{post.title}</PostTitle>\n      <PostPic src={post.imageUrl}></PostPic>\n      <PostDesc>{post.createdAt?.toDate().toLocaleString([],{year: 'numeric', month: 'numeric', day: 'numeric'})} | {post.topic}</PostDesc>\n      <PostContentWrapper dangerouslySetInnerHTML={{__html: post.content}}/>\n      </PostContainer>\n      <LikePush>覺得文章不錯嗎？按個讚吧！</LikePush>\n      <LikeButtonDiv isLiked={isLiked} onClick={toggleLiked}>\n        <FontAwesomeIcon icon={faHeart} />\n        <LikeNumber>{post.likedBy?.length}</LikeNumber>\n      </LikeButtonDiv>\n      <AuthorContainer>\n        <AuthorContainerTitle>關於作者</AuthorContainerTitle>\n        <AuthorImg><img alt='' src={authorInfo?.photoURL ? authorInfo?.photoURL : '/default-user-image.png'}/></AuthorImg>\n        <AuthorInfo>\n          <AuthorName>{authorInfo?.displayName}</AuthorName>\n          <AuthorDesc>{authorInfo?.introduction}</AuthorDesc>\n        </AuthorInfo>\n      </AuthorContainer>\n      <CommentArea area={'posts'} id={postId} />\n    </BlogPostPageContainer>\n    </>\n  )\n}\n\nexport default BlogPost\n"]},"metadata":{},"sourceType":"module"}
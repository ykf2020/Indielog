{"ast":null,"code":"import _regeneratorRuntime from\"/Users/fanyukun/Documents/react/indielog/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/fanyukun/Documents/react/indielog/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import{useSelector,useDispatch}from\"react-redux\";import{FontAwesomeIcon}from'@fortawesome/react-fontawesome';import{faHeart,faPlay}from'@fortawesome/free-solid-svg-icons';import{setCurrentSong}from\"../../redux/reducers/songReducer\";import{setMode,setIsPlaying}from\"../../redux/reducers/playerControlReducer\";import Carou from'../../components/Carousel/index.js';import'bootstrap/dist/css/bootstrap.min.css';import{toggleSongLiked}from'../../utils/firebase';import{Container,SongsList,Title,Song,SongInfo,SongName,AuthorName,SongButtons,NumberDiv,Number,ImgDiv,SongDesc,LikeButtonDiv,ImgContainer,LikeNumber,HoverPlayButton}from'./MusicElements.js';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Music=function Music(){var dispatch=useDispatch();var user=useSelector(function(store){return store.user.currentUser;});var songs=useSelector(function(store){return store.song.songs;});function playSong(_x){return _playSong.apply(this,arguments);}function _playSong(){_playSong=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(song){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return dispatch(setIsPlaying(true));case 2:_context.next=4;return dispatch(setCurrentSong(song));case 4:_context.next=6;return dispatch(setMode(2));case 6:case\"end\":return _context.stop();}}},_callee);}));return _playSong.apply(this,arguments);}function toggleLiked(isLiked,songId){if(!user){alert('請先登入會員才能按讚～');return;}toggleSongLiked(isLiked,songId,user.uid);}return/*#__PURE__*/_jsxs(Container,{children:[/*#__PURE__*/_jsx(Carou,{}),/*#__PURE__*/_jsxs(SongsList,{children:[/*#__PURE__*/_jsx(Title,{children:\"\\u71B1\\u9580\\u6392\\u884C\"}),songs.map(function(song,index){var isLiked=song===null||song===void 0?void 0:song.likedBy.includes(user===null||user===void 0?void 0:user.uid);return/*#__PURE__*/_jsxs(Song,{children:[/*#__PURE__*/_jsxs(SongInfo,{children:[/*#__PURE__*/_jsx(NumberDiv,{children:/*#__PURE__*/_jsx(Number,{children:index+1})}),/*#__PURE__*/_jsxs(ImgContainer,{children:[/*#__PURE__*/_jsx(ImgDiv,{children:/*#__PURE__*/_jsx(\"img\",{alt:\"\",src:song===null||song===void 0?void 0:song.cover})}),/*#__PURE__*/_jsx(HoverPlayButton,{onClick:function onClick(){return playSong(song);},children:/*#__PURE__*/_jsx(FontAwesomeIcon,{size:\"2x\",icon:faPlay})})]}),/*#__PURE__*/_jsxs(SongDesc,{to:\"/songs/\".concat(song===null||song===void 0?void 0:song.id),children:[/*#__PURE__*/_jsx(SongName,{children:song===null||song===void 0?void 0:song.name}),/*#__PURE__*/_jsx(AuthorName,{children:song===null||song===void 0?void 0:song.artist})]})]}),/*#__PURE__*/_jsx(SongButtons,{children:/*#__PURE__*/_jsxs(LikeButtonDiv,{isLiked:isLiked,onClick:function onClick(){return toggleLiked(isLiked,song.id);},children:[/*#__PURE__*/_jsx(FontAwesomeIcon,{size:\"1x\",icon:faHeart}),/*#__PURE__*/_jsx(LikeNumber,{isLiked:isLiked,children:song===null||song===void 0?void 0:song.likedBy.length})]})})]},song===null||song===void 0?void 0:song.id);})]})]});};export default Music;","map":{"version":3,"sources":["/Users/fanyukun/Documents/react/indielog/src/pages/Music/index.js"],"names":["useSelector","useDispatch","FontAwesomeIcon","faHeart","faPlay","setCurrentSong","setMode","setIsPlaying","Carou","toggleSongLiked","Container","SongsList","Title","Song","SongInfo","SongName","AuthorName","SongButtons","NumberDiv","Number","ImgDiv","SongDesc","LikeButtonDiv","ImgContainer","LikeNumber","HoverPlayButton","Music","dispatch","user","store","currentUser","songs","song","playSong","toggleLiked","isLiked","songId","alert","uid","map","index","likedBy","includes","cover","id","name","artist","length"],"mappings":"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","sourcesContent":["import { useSelector, useDispatch } from \"react-redux\";\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\nimport { faHeart, faPlay } from '@fortawesome/free-solid-svg-icons'\nimport { setCurrentSong } from \"../../redux/reducers/songReducer\";\nimport { setMode, setIsPlaying } from \"../../redux/reducers/playerControlReducer\"\nimport Carou from '../../components/Carousel/index.js';\nimport 'bootstrap/dist/css/bootstrap.min.css';\nimport { toggleSongLiked } from '../../utils/firebase'\nimport {\n  Container,\n  SongsList,\n  Title,\n  Song,\n  SongInfo,\n  SongName,\n  AuthorName,\n  SongButtons,\n  NumberDiv,\n  Number,\n  ImgDiv,\n  SongDesc,\n  LikeButtonDiv,\n  ImgContainer,\n  LikeNumber,\n  HoverPlayButton,\n} from './MusicElements.js'\n\n\nconst Music = () => {\n  const dispatch = useDispatch()\n  const user = useSelector((store) => store.user.currentUser)\n  const songs = useSelector((store) => store.song.songs)\n  async function playSong(song){\n    await dispatch(setIsPlaying(true))\n    await dispatch(setCurrentSong(song))\n    await dispatch(setMode(2))\n  }\n\n  function toggleLiked(isLiked, songId) {\n    if(!user) {\n      alert('請先登入會員才能按讚～')\n      return\n    }\n    toggleSongLiked(isLiked, songId, user.uid)\n  }\n  return (\n    <Container >\n      <Carou />\n      <SongsList>\n        <Title>熱門排行</Title>\n        {songs.map((song,index) => {\n          const isLiked = song?.likedBy.includes(user?.uid)\n          return (\n            <Song key={song?.id}>\n              <SongInfo>\n                <NumberDiv>\n                  <Number>{index + 1}</Number>\n                </NumberDiv>\n                <ImgContainer>\n                  <ImgDiv>\n                    <img alt='' src={song?.cover}/>\n                  </ImgDiv>\n                  <HoverPlayButton onClick={() => playSong(song)}>\n                    <FontAwesomeIcon size=\"2x\" icon={faPlay} />\n                  </HoverPlayButton>\n                </ImgContainer>\n                <SongDesc to={`/songs/${song?.id}`}>\n                  <SongName>{song?.name}</SongName>\n                  <AuthorName>{song?.artist}</AuthorName>\n                </SongDesc>\n              </SongInfo>\n              <SongButtons>\n                <LikeButtonDiv isLiked={isLiked} onClick={() => toggleLiked(isLiked, song.id)}>\n                  <FontAwesomeIcon size='1x' icon={faHeart}/>\n                  <LikeNumber isLiked={isLiked}>{song?.likedBy.length}</LikeNumber>\n                </LikeButtonDiv>\n              </SongButtons>\n            </Song>\n          )\n        })}\n      </SongsList>\n    </Container>\n  )\n}\n\nexport default Music\n"]},"metadata":{},"sourceType":"module"}
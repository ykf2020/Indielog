{"ast":null,"code":"import firebase from 'firebase/compat/app';\nimport 'firebase/compat/auth';\nimport 'firebase/compat/firestore';\nimport 'firebase/compat/storage';\nconst firebaseConfig = {\n  apiKey: \"AIzaSyDjquiByhMI0pc7g_Cx482Kp2tK-c1mlQ8\",\n  authDomain: \"indielog-172c8.firebaseapp.com\",\n  projectId: \"indielog-172c8\",\n  storageBucket: \"indielog-172c8.appspot.com\",\n  messagingSenderId: \"97403270536\",\n  appId: \"1:97403270536:web:5ea48f5aa3c58801bdf63d\"\n};\nfirebase.initializeApp(firebaseConfig);\nconst db = firebase.firestore();\nconst auth = firebase.auth();\nconst usersDb = db.collection('users');\nconst postsDb = db.collection('posts');\nconst songsDb = db.collection('songs');\nconst topicsDb = db.collection('topics');\nexport const signOut = () => {\n  auth.signOut();\n};\nexport const checkUserStatus = handleUser => {\n  auth.onAuthStateChanged(user => {\n    if (user) {\n      handleUser({\n        uid: user.uid,\n        displayName: user.displayName,\n        email: user.email,\n        photoURL: user.photoURL\n      });\n    } else {\n      handleUser(null);\n    }\n  });\n};\nexport const forgetPassword = email => {\n  auth.sendPasswordResetEmail(email);\n};\nexport const getTopics = handleTopics => {\n  topicsDb.get().then(collectionSnapShot => {\n    const data = collectionSnapShot.docs.map(doc => {\n      const id = doc.id;\n      return { ...doc.data(),\n        id\n      };\n    });\n    handleTopics(data);\n  });\n};\nexport const getPostsWithoutTopic = handlePosts => {\n  postsDb.orderBy('createdAt', 'desc').get().then(collectionSnapShot => {\n    const data = collectionSnapShot.docs.map(doc => {\n      const id = doc.id;\n      return { ...doc.data(),\n        id\n      };\n    });\n    handlePosts(data);\n  });\n};\nexport const getPostsWithTopic = (topic, handlePosts) => {\n  postsDb.orderBy('createdAt', 'desc').where('topic', '==', topic).get().then(collectionSnapShot => {\n    const data = collectionSnapShot.docs.map(doc => {\n      const id = doc.id;\n      return { ...doc.data(),\n        id\n      };\n    });\n    handlePosts(data);\n  });\n};\nexport const getAuthorInfo = (authorId, handleAuthorInfo) => {\n  usersDb.doc(authorId).get().then(userSnapShot => {\n    handleAuthorInfo(userSnapShot.data());\n  });\n};\nexport const addNewComment = (area, id, commentContent, authorId) => {\n  return db.collection(area).doc(id).collection('comments').doc().set({\n    content: commentContent,\n    createdAt: firebase.firestore.Timestamp.now(),\n    authorUid: authorId\n  });\n};\nexport const getCommentsOnSnapshot = (area, id, handleComments) => {\n  db.collection(area).doc(id).collection('comments').orderBy('createdAt', 'asc').onSnapshot(collectionSnapShot => {\n    const data = collectionSnapShot.docs.map(doc => {\n      return {\n        authorUid: doc.data().authorUid,\n        content: doc.data().content,\n        createdAt: doc.data().createdAt\n      };\n    });\n    handleComments(data);\n  });\n};\nexport default firebase;","map":{"version":3,"sources":["/Users/fanyukun/Documents/react/indielog/src/utils/firebase.js"],"names":["firebase","firebaseConfig","apiKey","authDomain","projectId","storageBucket","messagingSenderId","appId","initializeApp","db","firestore","auth","usersDb","collection","postsDb","songsDb","topicsDb","signOut","checkUserStatus","handleUser","onAuthStateChanged","user","uid","displayName","email","photoURL","forgetPassword","sendPasswordResetEmail","getTopics","handleTopics","get","then","collectionSnapShot","data","docs","map","doc","id","getPostsWithoutTopic","handlePosts","orderBy","getPostsWithTopic","topic","where","getAuthorInfo","authorId","handleAuthorInfo","userSnapShot","addNewComment","area","commentContent","set","content","createdAt","Timestamp","now","authorUid","getCommentsOnSnapshot","handleComments","onSnapshot"],"mappings":"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","sourcesContent":["import firebase from 'firebase/compat/app'\nimport 'firebase/compat/auth'\nimport 'firebase/compat/firestore'\nimport 'firebase/compat/storage'\n\nconst firebaseConfig = {\n  apiKey: \"AIzaSyDjquiByhMI0pc7g_Cx482Kp2tK-c1mlQ8\",\n  authDomain: \"indielog-172c8.firebaseapp.com\",\n  projectId: \"indielog-172c8\",\n  storageBucket: \"indielog-172c8.appspot.com\",\n  messagingSenderId: \"97403270536\",\n  appId: \"1:97403270536:web:5ea48f5aa3c58801bdf63d\"\n};\n\nfirebase.initializeApp(firebaseConfig);\n\nconst db = firebase.firestore();\nconst auth = firebase.auth();\nconst usersDb = db.collection('users')\nconst postsDb = db.collection('posts')\nconst songsDb = db.collection('songs')\nconst topicsDb = db.collection('topics')\n\n\nexport const signOut = () => {\n  auth.signOut()\n}\n\nexport const checkUserStatus = (handleUser) => {\n  auth.onAuthStateChanged((user) => {\n    if(user) {\n      handleUser({\n        uid: user.uid,\n        displayName: user.displayName,\n        email: user.email,\n        photoURL: user.photoURL\n      })\n    } else {\n      handleUser(null)\n    }\n  })\n}\n\nexport const forgetPassword = (email) => {\n  auth.sendPasswordResetEmail(email)\n}\n\nexport const getTopics = (handleTopics) => {\n  topicsDb.get().then((collectionSnapShot) => {\n    const data = collectionSnapShot.docs.map((doc) => {\n      const id = doc.id\n      return {...doc.data(),id}\n    })\n    handleTopics(data)\n  })\n}\n\nexport const getPostsWithoutTopic = (handlePosts) => {\n  postsDb.orderBy('createdAt','desc').get().then((collectionSnapShot) => {\n    const data = collectionSnapShot.docs.map((doc) => {\n      const id = doc.id\n      return {...doc.data(),id}\n    })\n    handlePosts(data)\n  })\n}\n\nexport const getPostsWithTopic = (topic, handlePosts) => {\n  postsDb.orderBy('createdAt','desc').where('topic','==',topic).get().then((collectionSnapShot) => {\n    const data = collectionSnapShot.docs.map((doc) => {\n      const id = doc.id\n      return {...doc.data(),id}\n    })\n    handlePosts(data)\n  })\n}\n\nexport const getAuthorInfo = (authorId, handleAuthorInfo) => {\n  usersDb.doc(authorId).get().then((userSnapShot) => {\n    handleAuthorInfo(userSnapShot.data())\n  })\n}\n\nexport const addNewComment = (area, id, commentContent, authorId) => {\n  return db.collection(area).doc(id).collection('comments').doc().set({\n    content: commentContent,\n    createdAt: firebase.firestore.Timestamp.now(),\n    authorUid: authorId,\n  })\n}\n\nexport const getCommentsOnSnapshot = (area, id, handleComments) => {\n  db.collection(area).doc(id).collection('comments').orderBy('createdAt','asc').onSnapshot((collectionSnapShot) => {\n     const data = collectionSnapShot.docs.map((doc) => {\n       return {\n         authorUid: doc.data().authorUid,\n         content: doc.data().content,\n         createdAt: doc.data().createdAt\n       }\n     })\n     handleComments(data)\n  })\n}\n\nexport default firebase\n"]},"metadata":{},"sourceType":"module"}
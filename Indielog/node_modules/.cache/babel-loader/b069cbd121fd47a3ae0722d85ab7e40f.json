{"ast":null,"code":"var _jsxFileName = \"/Users/fanyukun/Documents/react/indielog/src/components/MusicPlayer/index.js\",\n    _s2 = $RefreshSig$();\n\nimport { useRef } from 'react';\nimport MusicPlayerSmall from '../MusicPlayerSmall';\nimport MusicPlayerFull from '../MusicPlayerFull';\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nconst MusicPlayer = () => {\n  _s2();\n\n  var _s = $RefreshSig$();\n\n  const audioRef = useRef(null);\n  const isPlaying = useSelector(store => store.playerControl.isPlaying);\n  const sound = useSelector(store => store.playerControl.sound);\n  const songPlayingInfo = useSelector(store => store.playerControl.songPlayingInfo);\n  const songs = useSelector(store => store.song.songs);\n  const currentSong = useSelector(store => store.song.currentSong);\n  const libraryStatus = useSelector(store => store.playerControl.libraryStatus);\n\n  const timeUpdateHandler = e => {\n    _s();\n\n    const dispatch = useDispatch();\n    const current = e.target.currentTime;\n    const duration = e.target.duration;\n    const roundedCurrent = Math.round(current);\n    const roundedDuration = Math.round(duration);\n    const animationPercentage = Math.round(roundedCurrent / roundedDuration * 100);\n    dispatch(setSongPlayingInfo({ ...songPlayingInfo,\n      currentTime: current,\n      duration,\n      animationPercentage\n    }));\n    console.log(sound);\n  };\n\n  _s(timeUpdateHandler, \"rgTLoBID190wEKCp9+G8W6F7A5M=\", false, function () {\n    return [useDispatch];\n  });\n\n  const songEndHandler = () => {\n    let currentIndex = songs.findIndex(song => song.id === currentSong.id);\n    dispatch(setCurrentSong(songs[(currentIndex + 1) % songs.length]));\n    if (isPlaying) audioRef.current.play();\n  };\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(MusicPlayerSmall, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 38,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(MusicPlayerFull, {\n      audioRef: audioRef\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 39,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"audio\", {\n      volume: sound.volume,\n      muted: sound.mute,\n      onTimeUpdate: timeUpdateHandler,\n      onLoadedMetadata: timeUpdateHandler,\n      ref: audioRef,\n      src: currentSong.audio,\n      onEnded: songEndHandler\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 40,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n};\n\n_s2(MusicPlayer, \"1YNTs42GaHlyJC3qr8DS5P6qXaY=\", false, function () {\n  return [useSelector, useSelector, useSelector, useSelector, useSelector, useSelector];\n});\n\n_c = MusicPlayer;\nexport default MusicPlayer;\n\nvar _c;\n\n$RefreshReg$(_c, \"MusicPlayer\");","map":{"version":3,"sources":["/Users/fanyukun/Documents/react/indielog/src/components/MusicPlayer/index.js"],"names":["useRef","MusicPlayerSmall","MusicPlayerFull","useDispatch","useSelector","MusicPlayer","audioRef","isPlaying","store","playerControl","sound","songPlayingInfo","songs","song","currentSong","libraryStatus","timeUpdateHandler","e","dispatch","current","target","currentTime","duration","roundedCurrent","Math","round","roundedDuration","animationPercentage","setSongPlayingInfo","console","log","songEndHandler","currentIndex","findIndex","id","setCurrentSong","length","play","volume","mute","audio"],"mappings":"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","sourcesContent":["import { useRef } from 'react'\nimport MusicPlayerSmall from '../MusicPlayerSmall'\nimport MusicPlayerFull from '../MusicPlayerFull'\nimport { useDispatch, useSelector } from \"react-redux\";\n\nconst MusicPlayer = () => {\n  const audioRef = useRef(null)\n  const isPlaying = useSelector((store) => store.playerControl.isPlaying)\n  const sound = useSelector((store) => store.playerControl.sound)\n  const songPlayingInfo = useSelector((store) => store.playerControl.songPlayingInfo)\n  const songs = useSelector((store) => store.song.songs)\n  const currentSong = useSelector((store) => store.song.currentSong)\n  const libraryStatus = useSelector((store) => store.playerControl.libraryStatus)\n\n  const timeUpdateHandler = (e) => {\n    const dispatch = useDispatch()\n    const current = e.target.currentTime\n    const duration = e.target.duration\n    const roundedCurrent = Math.round(current)\n    const roundedDuration = Math.round(duration)\n    const animationPercentage = Math.round((roundedCurrent / roundedDuration) * 100 )\n    dispatch(setSongPlayingInfo({\n      ...songPlayingInfo,\n      currentTime: current,\n      duration,\n      animationPercentage,\n    }))\n    console.log(sound)\n  }\n\n  const songEndHandler = () => {\n    let currentIndex = songs.findIndex((song) => song.id === currentSong.id)\n    dispatch(setCurrentSong(songs[(currentIndex + 1) % songs.length]))\n    if (isPlaying) audioRef.current.play()\n  }\n  return (\n    <>\n      <MusicPlayerSmall />\n      <MusicPlayerFull audioRef={audioRef} />\n      <audio\n        volume={sound.volume}\n        muted={sound.mute}\n        onTimeUpdate={timeUpdateHandler}\n        onLoadedMetadata={timeUpdateHandler}\n        ref={audioRef}\n        src={currentSong.audio}\n        onEnded={songEndHandler}\n      ></audio>\n\n    </>\n  )\n}\n\nexport default MusicPlayer\n"]},"metadata":{},"sourceType":"module"}